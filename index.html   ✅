<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Schussz√§hler</title>

<style>
* {
    box-sizing: border-box;
}

body {
    margin: 0;
    padding: 16px;
    background: #c9b8a6;
    font-family: Calibri, Arial, sans-serif;
}

/* Hauptkarte */
.container {
    max-width: 480px;
    margin: auto;
    background: #f1e8dd;
    padding: 18px;
    border-radius: 14px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.25);
}

h1 {
    text-align: center;
    margin-bottom: 18px;
}

/* Labels */
label {
    display: block;
    margin-top: 14px;
    font-weight: bold;
    font-size: 14px;
}

/* === DER ENTSCHEIDENDE FIX === */
.field {
    width: 100%;
    overflow: hidden;          /* üîí schneidet ALLES ab */
    border-radius: 8px;
    margin-top: 6px;
}

/* Inputs / Selects */
input,
select {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    border: 1px solid #b5a896;
    background: #fff;
    border-radius: 8px;

    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
}

/* oberstes Feld leicht gr√ºn */
#geraetNeu {
    background: #e9f6e6;
    border-color: #7fb27f;
}

/* Spinner & Extras ENTFERNEN */
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
}
input[type=number] {
    -moz-appearance: textfield;
}

/* Buttons */
button {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    margin-top: 14px;
}

.primary { background:#2f6fb0; color:white; }
.secondary { background:#e3dbd1; border:1px solid #b5a896; }
.danger { background:#b7372a; color:white; }

/* Gesamt */
.total {
    margin: 20px 0;
    padding: 18px;
    background: white;
    border-radius: 12px;
    text-align: center;
    font-size: 22px;
    font-weight: bold;
    border: 1px solid #b5a896;
}

.info {
    text-align: center;
    font-size: 12px;
    margin-top: 14px;
    color: #555;
}
</style>
</head>

<body>
<div class="container">

<h1>Schussz√§hler</h1>

<label>Neues Sportger√§t</label>
<div class="field">
    <input type="text" id="geraetNeu" placeholder="z.B. Stgw 57">
</div>
<button class="secondary" onclick="neuesGeraet()">Hinzuf√ºgen</button>

<label>Sportger√§t ausw√§hlen</label>
<div class="field">
    <select id="geraetSelect" onchange="ladeGeraet()">
        <option value="">‚Äì ausw√§hlen ‚Äì</option>
    </select>
</div>

<label>Startsaldo</label>
<div class="field">
    <input type="number" id="startsaldo" oninput="aktualisieren()">
</div>

<label>Neuer Eintrag</label>
<div class="field">
    <input type="number" id="neuerEintrag">
</div>
<button class="primary" onclick="addEintrag()">Eintrag hinzuf√ºgen</button>

<div class="total">
Gesamt<br><span id="total">0</span>
</div>

<button class="secondary" onclick="laufwechsel()">Neuer Lauf</button>
<button class="secondary" onclick="exportCSV()">Export CSV</button>
<button class="danger" onclick="geraetLoeschen()">Sportger√§t l√∂schen</button>

<div class="info">
Offlinef√§hig ¬∑ Daten nur lokal gespeichert
</div>

</div>

<script>
let daten = JSON.parse(localStorage.getItem("schusszaehler")) || {};
let aktuellesGeraet = "";

function speichern(){ localStorage.setItem("schusszaehler", JSON.stringify(daten)); }

function ladeDropdown(){
    geraetSelect.innerHTML='<option value="">‚Äì ausw√§hlen ‚Äì</option>';
    for(let g in daten){
        const o=document.createElement("option");
        o.value=g; o.text=g;
        geraetSelect.appendChild(o);
    }
}

function neuesGeraet(){
    const n=geraetNeu.value.trim();
    if(!n) return;
    daten[n]={startsaldo:0,eintraege:[]};
    speichern(); geraetNeu.value="";
    ladeDropdown(); geraetSelect.value=n; ladeGeraet();
}

function ladeGeraet(){
    aktuellesGeraet=geraetSelect.value;
    if(!aktuellesGeraet) return;
    startsaldo.value=daten[aktuellesGeraet].startsaldo;
    anzeigen();
}

function aktualisieren(){
    if(!aktuellesGeraet) return;
    daten[aktuellesGeraet].startsaldo=Number(startsaldo.value)||0;
    anzeigen();
}

function addEintrag(){
    if(!aktuellesGeraet) return;
    const w=Number(neuerEintrag.value);
    if(w<=0) return;
    daten[aktuellesGeraet].eintraege.push({menge:w});
    neuerEintrag.value=""; speichern(); anzeigen();
}

function anzeigen(){
    let t=daten[aktuellesGeraet].startsaldo;
    daten[aktuellesGeraet].eintraege.forEach(e=>t+=e.menge);
    total.innerText=t;
}

function laufwechsel(){
    if(!aktuellesGeraet||!confirm("Neuen Lauf starten?")) return;
    daten[aktuellesGeraet]={startsaldo:0,eintraege:[]};
    startsaldo.value=0; anzeigen();
}

function geraetLoeschen(){
    if(!aktuellesGeraet||!confirm("Sportger√§t l√∂schen?")) return;
    delete daten[aktuellesGeraet]; aktuellesGeraet="";
    speichern(); ladeDropdown(); total.innerText="0";
}

function exportCSV(){
    if(!aktuellesGeraet) return;
    let csv="Menge\n";
    daten[aktuellesGeraet].eintraege.forEach(e=>csv+=e.menge+"\n");
    const a=document.createElement("a");
    a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
    a.download="schussliste.csv"; a.click();
}

window.onload=ladeDropdown;
</script>
</body>
</html>
